!...This subroutine is copied from Xiao's code
!...Generate Gauss points x(:) and weights w(:) of n-point formula
SUBROUTINE GaussIntPoint(n, x, w)
  USE DefinitionConstant
  IMPLICIT NONE
  
  INTEGER, INTENT(in) :: n
  REAL(KIND=DBL), INTENT(out),DIMENSION(*)  :: x, w
  REAL(KIND=DBL) :: eps
  INTEGER        :: i, j, m
  REAL(KIND=DBL) :: pi, x1, x2, xm, xl, z, z1, p1, p2, p3, pp 

  eps = 3.d-14
  pi = dacos(-1.0d0)
  
  x1 = -1.0d0
  x2 = 1.0d0
  m = (n+1)/2
  xm = 0.5d0*(x2 + x1)
  xl = 0.5d0*(x2 - x1)
  DO  i = 1, m
    z = dcos(pi*(i-0.25d0)/(n+0.5d0))
    DO
      p1 = 1.0d0
      p2 = 0.0d0
      DO j = 1, n
        p3 = p2
        p2 = p1
        p1 = ((2.0d0*j-1.0d0)*z*p2-(j-1.0d0)*p3)/j
      END DO
      pp = n*(z*p1-p2)/(z*z-1.0d0)
      z1 = z
      z = z1-p1/pp
      IF(dabs(z-z1) < eps) EXIT
    END DO
    x(i) = xm-xl*z
    x(n+1-i) = xm+xl*z
    w(i) = 2.0d0*xl/((1.0d0-z*z)*pp*pp)
    w(n+1-i) = w(i)
  END DO

END SUBROUTINE GaussIntPoint
!--------------------------------------------------------------------------------
Subroutine LogIntPoint(n,x,w)
!...Gauss points and weights for logarith integration
	USE DefinitionConstant
    IMPLICIT NONE

    INTEGER, INTENT(in) :: n
	REAL(KIND=DBL), INTENT(out) :: x(n), w(n)

    Select case (n)
    !...Note: since x and w are double precision, then all of them will be cut
    !...at the 15th significant digit (after round off depending on the next digit)
      	case (2)
			x(1) = 0.112008806166976182957205488948d0
            w(1) = 0.718539319030384440665510200891d0
			x(2) = 0.602276908118738102757080225338d0
            w(2) = 0.281460680969615559334489799109d0
        case (3)
			x(1) = 0.638907930873254049961166031363d-1
            w(1) = 0.513404552232363325129300497567d0
			x(2) = 0.368997063715618765546197645857d0
            w(2) = 0.391980041201487554806287180966d0
			x(3) = 0.766880303938941455423682659817d0
            w(3) = 0.946154065661491200644123214672d-1
		case (4)
        	x(1) = 0.414484801993832208033213101564d-1
            w(1) = 0.383464068145135124850046522343d0
			x(2) = 0.245274914320602251939675759523d0
            w(2) = 0.386875317774762627336008234554d0
			x(3) = 0.556165453560275837180184354376d0
            w(3) = 0.190435126950142415361360014547d0
			x(4) = 0.848982394532985174647849188085d0
            w(4) = 0.392254871299598324525852285552d-1
        case (5)
        	x(1) = 0.291344721519720533037267621154d-1
            w(1) = 0.297893471782894457272257877888d0
			x(2) = 0.173977213320897628701139710829d0
            w(2) = 0.349776226513224180375071870307d0
			x(3) = 0.411702520284902043174931924646d0
            w(3) = 0.234488290044052418886906857943d0
			x(4) = 0.677314174582820380701802667998d0
            w(4) = 0.989304595166331469761807114404d-1
			x(5) = 0.894771361031008283638886204455d0
            w(5) = 0.189115521431957964895826824218d-1
        case (6)
        	x(1) = 0.216340058441169489956958558537d-1
            w(1) = 0.23876366257854756972226830333d0
			x(2) = 0.129583391154950796131158505009d0
            w(2) = 0.308286573273946792969383109211d0
			x(3) = 0.314020449914765508798248188420d0
            w(3) = 0.245317426563210385984932540188d0
			x(4) = 0.538657217351802144548941893993d0
            w(4) = 0.142008756566476685421345576030d0
			x(5) = 0.756915337377402852164544156139d0
            w(5) = 0.554546223248862900151353549662d-1
			x(6) = 0.922668851372120237333873231507d0
            w(6) = 0.101689586929322758869351162755d-1
        case (7)
        	x(1) = 0.16719355408258515941667360932d-1
            w(1) = 0.196169389425248207525427377585d0
			x(2) = 0.100185677915675121586885031757d0
            w(2) = 0.270302644247272982145271719533d0
			x(3) = 0.246294246207930599046668547239d0
            w(3) = 0.239681873007690948308072785252d0
			x(4) = 0.433463493257033105832882482601d0
            w(4) = 0.165775774810432906560869687736d0
			x(5) = 0.632350988047766088461805812245d0
            w(5) = 0.889432271376579644357238403458d-1
			x(6) = 0.811118626740105576526226796782d0
            w(6) = 0.331943043565710670254494111034d-1
			x(7) = 0.940848166743347721760134113379d0
            w(7) = 0.593278701512592399918517844468d-2
        case(8)
        	x(1) = 0.133202441608924650122526725243d-1
            w(1) = 0.164416604728002886831472568326d0
			x(2) = 0.797504290138949384098277291424d-1
            w(2) = 0.237525610023306020501348561960d0
			x(3) = 0.197871029326188053794476159516d0
            w(3) = 0.226841984431919126368780402936d0
			x(4) = 0.354153994351909419671463603538d0
            w(4) = 0.175754079006070244988056212006d0
			x(5) = 0.529458575234917277706149699996d0
            w(5) = 0.112924030246759051855000442086d0
			x(6) = 0.701814529939099963837152670310d0
            w(6) = 0.578722107177820723985279672940d-1
			x(7) = 0.849379320441106676048309202301d0
            w(7) = 0.209790737421329780434615241150d-1
			x(8) = 0.953326450056359788767379678514d0
            w(8) = 0.368640710402761901335232127647d-2
        case (9)
        	x(1) = 0.108693360841754771134426025221d-1
            w(1) = 0.140068438748134734268446086048d0
			x(2) = 0.649836663380079394067639216972d-1
            w(2) = 0.209772205201030447504841847183d0
			x(3) = 0.162229398023882938703509846472d0
            w(3) = 0.211427149896602728539721050205d0
			x(4) = 0.293749903971674658072412221908d0
            w(4) = 0.177156233938079989544890234989d0
			x(5) = 0.446631881905468037207219418890d0
            w(5) = 0.127799228033205495884960246733d0
			x(6) = 0.605481662776128620840632677514d0
            w(6) = 0.784789026115621725466730792292d-1
			x(7) = 0.754110137157163566650861719456d0
            w(7) = 0.390225049853990968472827356425d-1
			x(8) = 0.877265828835838253173478212614d0
            w(8) = 0.138672955495930232902178433277d-1
			x(9) = 0.962250559410281841440431900026d0
            w(9) = 0.240804103639231157296687664295d-2
        case (10)
			x(1) = 0.904263096219965063694662745251d-2
            w(1) = 0.120955131954570514988582388553d0
			x(2) = 0.539712662225006295042012263704d-1
            w(2) = 0.186363542564071870327415761808d0
			x(3) = 0.135311824639250774870232111120d0
            w(3) = 0.195660873277759982710442500258d0
			x(4) = 0.247052416287159824222545443293d0
            w(4) = 0.173577142182906920840382679110d0
			x(5) = 0.380212539609332333972341265091d0
            w(5) = 0.135695672995484201669911621386d0
			x(6) = 0.52379231797184320116116382464d0
            w(6) = 0.93646758538110525987290648351d-1
			x(7) = 0.665775205516424597222381296904d0
            w(7) = 0.557877273514158740759075889448d-1
			x(8) = 0.794190416011966217358509331891d0
            w(8) = 0.271598108992333311459339153986d-1
			x(9) = 0.898161091219003538166953162341d0
            w(9) = 0.951518260284851499925482488176d-2
			x(10) = 0.968847988718633539391504526904d0
            w(10) = 0.163815763359826325487807130901d-2
        case (11)
        	x(1) = 0.764394117463770662922687714474d-2
            w(1) = 0.105652256099100491307889716884d0
			x(2) = 0.455418282565789185481473756727d-1
            w(2) = 0.166571680600629048638711360149d0
			x(3) = 0.114522297455124583696540400802d0
            w(3) = 0.180563218287753724765991810676d0
			x(4) = 0.210378581227033530889061006365d0
            w(4) = 0.167278736773784179325539137521d0
			x(5) = 0.326695553221692847978138630792d0
            w(5) = 0.138697057401631220502633779524d0
			x(6) = 0.455453246928813438311216818544d0
            w(6) = 0.103833433365044060277732638694d0
			x(7) = 0.587648356359084407899279511822d0
            w(7) = 0.69536697888735232346909310954d-1
			x(8) = 0.713963850012561440538526790659d0
            w(8) = 0.405416008035963295684502307321d-1
			x(9) = 0.825453217801811804173966299861d0
            w(9) = 0.194354024762181727807870655072d-1
			x(10) = 0.914193921612543137941639130438d0
            w(10) = 0.673742934245006270213122009748d-2
			x(11) = 0.973860256275586152323740229436d0
            w(11) = 0.115248696105747778322372926189d-2
		case (12)
        	x(1) = 0.654872227908005878925744960907d-2
            w(1) = 0.931926914439313244913277977276d-1
			x(2) = 0.389468095604499591619910280555d-1
            w(2) = 0.149751827576322364171777231022d0
			x(3) = 0.981502631060066288622981979596d-1
            w(3) = 0.166557454364593005321875557261d0
			x(4) = 0.181138581590631577353463585261d0
            w(4) = 0.159633559436987651160747851380d0
			x(5) = 0.283220067667372554704481495110d0
            w(5) = 0.138424831864835621067772292761d0
			x(6) = 0.398434435163436643701239367179d0
            w(6) = 0.110016570635721162336976648664d0
			x(7) = 0.519952626792352662726661685334d0
            w(7) = 0.799618217708289702648952525351d-1
			x(8) = 0.640510916716106454303577344168d0
            w(8) = 0.524069548246417706500833660994d-1
			x(9) = 0.752865012051830578370464647599d0
            w(9) = 0.300710888737611871238229606368d-1
			x(10) = 0.850240024162302200670351679815d0
            w(10) = 0.142492455879982791070136648695d-1
			x(11) = 0.926749683223914101046774595625d0
            w(11) = 0.489992458232176093901640845728d-2
			x(12) = 0.977756129689997479173448469850d0
            w(12) = 0.834029038056903364690968586785d-3
        case (13)
        	x(1) = 0.567476625624266902990661105202d-2
            w(1) = 0.829004967932757878188152152054d-1
			x(2) = 0.336901087990325367485568778257d-1
            w(2) = 0.135368673165744500407936042377d0
			x(3) = 0.850367544741750280898241764195d-1
            w(3) = 0.153773284392292200851493741803d0
			x(4) = 0.157497559477889028739324350981d0
            w(4) = 0.151458158509988190620138978008d0
			x(5) = 0.247569578876843146133633494457d0
            w(5) = 0.136040336537283060714817871301d0
			x(6) = 0.350744312360855200420114620219d0
            w(6) = 0.113176822881633803359870895460d0
			x(7) = 0.461773746761610246224517207379d0
            w(7) = 0.873744304800452582386827468353d-1
			x(8) = 0.574959466525561320742963043074d0
            w(8) = 0.621602306418048695178094975826d-1
			x(9) = 0.684459880350430042539231120698d0
            w(9) = 0.400877289341658518981217059843d-1
			x(10) = 0.784602568810347080515801611450d0
            w(10) = 0.227238449399721953280333847883d-1
			x(11) = 0.870186428407888388826049146213d0
            w(11) = 0.106712304129684440876596068468d-1
			x(12) = 0.936757829306751393372834303060d0
            w(12) = 0.364649227597414007976071733327d-2
			x(13) = 0.980843451811590948508515518491d0
            w(13) = 0.618270034851697076859596474784d-1
		case (14)
        	x(1) = 0.496600357386854224393692481784d-2
			w(1) = 0.742912250675104124987798363873d-1
			x(2) = 0.294325401188851782869838346607d-1
			w(2) = 0.122988772469322914298496312769d0
			x(3) = 0.743762922245357626102889980495d-1
			w(3) = 0.142199306562523355705377614756d0
			x(4) = 0.138138491989186281799499873342d0
			w(4) = 0.143229297641264222015577749402d0
			x(5) = 0.218055648498959078070573209930d0
			w(5) = 0.132345083772085209260656765525d0
			x(6) = 0.310662083918101983176473271785d0
			w(6) = 0.114135875736676475259018788798d0
			x(7) = 0.411872475177750207209466486299d0
			w(7) = 0.922830380790736132161077631426d-1
			x(8) = 0.517179307398654329723786278103d0
			w(8) = 0.697536732939375645503253346685d-1
			x(9) = 0.621864859728511119707185016702d0
			w(9) = 0.488303236005135646445107301107d-1
			x(10) = 0.721220745208108853736322524468d0
			w(10) = 0.311017960644161411178044821475d-1
			x(11) = 0.810765988071589856355814244541d0
			w(11) = 0.174628119501960938329580986147d-1
			x(12) = 0.886454038034434657188257676039d0
			w(12) = 0.814242342987593613322915652212d-2
			x(13) = 0.944859139461818638926297139958d0
			w(13) = 0.276843641856393733183692432943d-2
			x(14) = 0.983331026485678480048012197509d0
			w(14) = 0.467935914040560135320442826668d-3
		case (15)
			x(1) = 0.43831101754754038348493622744d-2
			w(1) = 0.670099789164937136032340532333d-1
			x(2) = 0.259358981053306161023357909534d-1
			w(2) = 0.112264150286705741827876701028d0
			x(3) = 0.655960954123162452541425293272d-1
			w(3) = 0.131760177039679903732458174589d0
			x(4) = 0.122101934073331603329818461097d0
			w(4) = 0.135217649061934725132090193150d0
			x(5) = 0.193395262374007115982613845396d0
			w(5) = 0.127881798645680370400726294602d0
			x(6) = 0.276772838706102024394304290495d0
			w(6) = 0.113532907490219421290148275469d0
			x(7) = 0.369015127139742943816372538175d0
			w(7) = 0.952052397843586585116088663523d-1
			x(8) = 0.466524328964706582676317523662d0
			w(8) = 0.753893141673959543392539169820d-1
			x(9) = 0.565473473791817306425163245050d0
			w(9) = 0.560784244926537179923248830224d-1
			x(10) = 0.661962919012456421389942316851d0
			w(10) = 0.387682953750182311100365655698d-1
			x(11) = 0.752178883378785798787611692655d0
			w(11) = 0.244514832687500759603623800635d-1
			x(12) = 0.832548033866189589257112852162d0
			w(12) = 0.136246301382388469053731638170d-1
			x(13) = 0.899882050120898084329683371552d0
			w(13) = 0.631644759859076119982691121434d-2
			x(14) = 0.951506188743409902725839065853d0
			w(14) = 0.213888991594447134782816649118d-2
			x(15) = 0.985364468122131938926962364282d0
			w(15) = 0.360613818335406646851454415791d-3
		case (16)
			x(1) = 0.389783448711591592405360527037d-2
            w(1) = 0.607917100435912328511733871235d-1
			x(2) = 0.230289456168732398203176309848d-1
            w(2) = 0.102915677517582144387691736210d0
			x(3) = 0.582803983062404123483532298394d-1
            w(3) = 0.122355662046009193557547513197d0
			x(4) = 0.108678365091054036487713613051d0
            w(4) = 0.127569246937015988717042209239d0
			x(5) = 0.172609454909843937760843776232d0
            w(5) = 0.123013574600070915423123365137d0
			x(6) = 0.247937054470578495147671753047d0
            w(6) = 0.111847244855485722621848903429d0
			x(7) = 0.332094549129917155984755859320d0
            w(7) = 0.965963851521243412529681650802d-1
			x(8) = 0.422183910581948600115088366745d0
            w(8) = 0.793566643514731387824416770520d-1
			x(9) = 0.515082473381462603476277704052d0
            w(9) = 0.618504945819652070951360853113d-1
			x(10) = 0.607556120447728724086384921709d0
            w(10) = 0.454352465077266686288299526509d-1
			x(11) = 0.696375653228214061156318166581d0
            w(11) = 0.310989747515818064092528627927d-1
			x(12) = 0.778432565873265405203868167732d0
            w(12) = 0.194597659273608420780860268669d-1
			x(13) = 0.850850269715391083233822761319d0
            w(13) = 0.107762549632055256455393162159d-1
			x(14) = 0.911086857222271905418818994060d0
            w(14) = 0.497254289008764171250524951646d-2
			x(15) = 0.957025571703542157591520509383d0
            w(15) = 0.167820111005119451503546419059d-2
			x(16) = 0.987047800247984476758697436516d0
            w(16) = 0.282353764668436321778085987413d-3
        case default
	        	print*,'incorrect logarith integration type'
    	        stop
    end select
End Subroutine LogIntPoint